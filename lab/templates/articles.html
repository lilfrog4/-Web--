{% extends "base.html" %}

{% block title %}–í—Å–µ —Å—Ç–∞—Ç—å–∏ - –ù–æ–≤–æ—Å—Ç–Ω–æ–π –ë–ª–æ–≥{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">–í—Å–µ —Å—Ç–∞—Ç—å–∏</h1>
        
        <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
        <div class="mb-4">
            <h5>–§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:</h5>
            <div class="btn-group" role="group">
                <a href="{{ url_for('articles') }}?sort={{ current_sort }}" 
                   class="btn {% if not current_category %}btn-primary{% else %}btn-outline-secondary{% endif %}">
                    –í—Å–µ
                </a>
                <a href="{{ url_for('articles') }}?category=general&sort={{ current_sort }}" 
                   class="btn {% if current_category == 'general' %}btn-primary{% else %}btn-outline-secondary{% endif %}">
                    –û–±—â–µ–µ
                </a>
                <a href="{{ url_for('articles') }}?category=politics&sort={{ current_sort }}" 
                   class="btn {% if current_category == 'politics' %}btn-primary{% else %}btn-outline-secondary{% endif %}">
                    –ü–æ–ª–∏—Ç–∏–∫–∞
                </a>
                <a href="{{ url_for('articles') }}?category=technology&sort={{ current_sort }}" 
                   class="btn {% if current_category == 'technology' %}btn-primary{% else %}btn-outline-secondary{% endif %}">
                    –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                </a>
                <a href="{{ url_for('articles') }}?category=sports&sort={{ current_sort }}" 
                   class="btn {% if current_category == 'sports' %}btn-primary{% else %}btn-outline-secondary{% endif %}">
                    –°–ø–æ—Ä—Ç
                </a>
                <a href="{{ url_for('articles') }}?category=culture&sort={{ current_sort }}" 
                   class="btn {% if current_category == 'culture' %}btn-primary{% else %}btn-outline-secondary{% endif %}">
                    –ö—É–ª—å—Ç—É—Ä–∞
                </a>
            </div>
        </div>

        <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ -->
        <div class="mb-4">
            <h5>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏:</h5>
            <div class="btn-group" role="group">
                <a href="{{ url_for('articles') }}{% if current_category %}?category={{ current_category }}&{% else %}?{% endif %}sort=newest" 
                   class="btn {% if current_sort == 'newest' %}btn-primary{% else %}btn-outline-primary{% endif %}">
                    üìÖ –°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ
                </a>
                <a href="{{ url_for('articles') }}{% if current_category %}?category={{ current_category }}&{% else %}?{% endif %}sort=oldest" 
                   class="btn {% if current_sort == 'oldest' %}btn-primary{% else %}btn-outline-primary{% endif %}">
                    üìÖ –°–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ
                </a>
            </div>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ö -->
        <div class="mb-4">
            {% if current_category %}
            <div class="alert alert-info d-flex justify-content-between align-items-center">
                <div>
                    üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <strong>{{ current_category }}</strong>
                    {% if current_sort == 'newest' %}
                    | üìÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: <strong>—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</strong>
                    {% elif current_sort == 'oldest' %}
                    | üìÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: <strong>—Å–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ</strong>
                    {% endif %}
                </div>
                <a href="{{ url_for('articles') }}?sort={{ current_sort }}" class="btn btn-sm btn-outline-info">
                    ‚ùå –û—á–∏—Å—Ç–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                </a>
            </div>
            {% else %}
            <div class="alert alert-secondary">
                üìÇ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º <strong>–≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</strong>
                {% if current_sort == 'newest' %}
                | üìÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: <strong>—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</strong>
                {% elif current_sort == 'oldest' %}
                | üìÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: <strong>—Å–Ω–∞—á–∞–ª–∞ —Å—Ç–∞—Ä—ã–µ</strong>
                {% endif %}
            </div>
            {% endif %}
        </div>

        {% if articles %}
            {% for article in articles %}
            <div class="card mb-4">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <h4 class="card-title">
                            <a href="{{ url_for('news_article', id=article.id) }}" class="text-decoration-none">
                                {{ article.title }}
                            </a>
                        </h4>
                        <div>
                            <span class="badge bg-secondary">{{ article.category }}</span>
                            {% if article.created_date.date() == current_date %}
                            <span class="badge bg-success">–ù–æ–≤–æ–µ!</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <p class="card-text">{{ article.text[:200] }}{% if article.text|length > 200 %}...{% endif %}</p>
                    
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <small class="text-muted">
                                üë§ –ê–≤—Ç–æ—Ä: {{ article.author.name }} | 
                                üìÖ {{ article.created_date.strftime('%d.%m.%Y %H:%M') }} |
                                üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: {{ article.comments|length }}
                            </small>
                        </div>
                        
                        {% if current_user.is_authenticated and article.author == current_user %}
                        <div>
                            <a href="{{ url_for('edit_article', id=article.id) }}" class="btn btn-sm btn-outline-primary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                            <a href="{{ url_for('delete_article', id=article.id) }}" class="btn btn-sm btn-outline-danger" 
                               onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é?')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="alert alert-warning">
                üì≠ –°—Ç–∞—Ç—å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('create_article') }}" class="alert-link">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é —Å—Ç–∞—Ç—å—é!</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}